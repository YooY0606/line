<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>捐血紀錄</title>
<style>
      input[type=submit]{
      background-color: #2f4bbb;
      border: 15px;
      color: white;
      padding: 15px;
      text-decoration: none;
      cursor: pointer;
   }
   table {
    border-collapse: collapse;
    width: 100%;
   }

    th, td {
    text-align: left;
    padding: 8px;
    }

    tr:nth-child(even) {background-color: #f2f2f2;}
</style>
</head>
   <body>
    <form method = "POST">
      <p><input class="form-control" type="hidden" id="userid"  name = "userid"/></p>
      <p><input type = "submit" value = "顯示" /></p>
      <table class="table table-striped table-hover" width="75%">
        <tr>
            <th scope="col">#</th>
            <th scope="col">捐血方式</th>
            <th scope="col">時間</th>

        </tr>
            {% set counter = 1 -%}
            {% for record in dataclip|sort(attribute="250cc全血", reverse = True) %}
            <tr>
                <th scope="row">{{ counter + loop.index0}}</th>
                <td>{{record["捐血方式"]}}</td>
                <td>{{record["時間"]}}</td>  
            </tr>
            {% endfor %}
      </table>
    </form>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
      <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
      <script>
            liff.init({
                     liffId: '1656899274-nYGwwb27'
                 })
                 .then(() => {
                  if (!liff.isLoggedIn()) {
                     alert("用戶未登入");
                     liff.login();
                  } 
                  else {
                  liff.getProfile()
                  .then(profile => {
                     $("#userid").val(profile.userId);
                     document.getElementById("pictureUrl").src = profile.pictureUrl;
                     const userId = profile.userId
                     })
                     .catch((err) => {
                     console.log('error', err);
                     })
                  }})
                 .catch((err) => {
                   console.log('初始化失敗')
                 })
     </script>
        
   </body>
</html>